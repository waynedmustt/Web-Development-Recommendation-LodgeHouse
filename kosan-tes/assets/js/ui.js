/* main_website/ui.js */

/* TrueCar.Utilities */
if(!window.TrueCar){throw new Error("TrueCar.Utilities requires TrueCar");}TrueCar.Utilities=TrueCar.Utilities||{VERSION:"0.9.5",isIE:function(a){var b=(/MSIE (\d+)\.\d+;/).test(navigator.userAgent);var c=new Number(RegExp.$1);if(b&&(!a||a==c)){return true;}return false;},formatNum:function(b,c,e){var d=parseInt(b,10).toFixed(e);var a=/(\d+)(\d{3})/;while(a.test(d)){d=d.replace(a,"$1,$2");}if(c){if(/-/.test(d)){d=d.replace("-","");c="-"+c;}d=c+d;}return d;},getSWF:function(b){var a=navigator.appName.indexOf("Microsoft")!=-1;return(a)?window[b]:document[b];},keyLookup:function(b,c){for(var a in c){if(c[a]==b){return a;}}},keySort:function(b,c,d){function a(f,e){if(d=="ASC"){return f[c]-e[c];}else{return e[c]-f[c];}}return b.sort(a);},indexOf:function(d,c){for(var b=0,a=d.length;b<a;b++){if(d[b]===c){return b;}}return -1;},compareArrays:function(g,f,j){if(g.length!=f.length){return false;}var e=g.slice(0);var d=f.slice(0);if(j){e.sort();d.sort();}for(var h=0,c=e.length;h<c;h++){if(e[h]!==d[h]){return false;}}return true;}};

/* jQuery Cookie 1.0 *modified* */
jQuery.cookie=function(b,j,m){if(typeof j!="undefined"){m=m||{};if(j===null){j="";m.expires=-1;}var e="";if(m.expires&&(typeof m.expires=="number"||m.expires.toUTCString)){var f;if(typeof m.expires=="number"){f=new Date();f.setTime(f.getTime()+(m.expires*60*60*1000));}else{f=m.expires;}e="; expires="+f.toUTCString();}var l=m.path?"; path="+(m.path):"";var g=m.domain?"; domain="+(m.domain):"";var a=m.secure?"; secure":"";document.cookie=[b,"=",encodeURIComponent(j),e,l,g,a].join("");}else{var d=null;if(document.cookie&&document.cookie!=""){var k=document.cookie.split(";");for(var h=0;h<k.length;h++){var c=jQuery.trim(k[h]);if(c.substring(0,b.length+1)==(b+"=")){d=decodeURIComponent(c.substring(b.length+1));break;}}}return d;}};

/* TrueCar.Cookie */
if(!window.TrueCar){throw new Error("TrueCar.Cookie requires TrueCar");}TrueCar.Cookie=TrueCar.Cookie||{VERSION:"0.9.0",_serialize:function(a){var c=[];for(var b in a){if(a.hasOwnProperty(b)){c.push(b+"="+encodeURIComponent(a[b]));}}return c.join("&");},_deserialize:function(c){var b={};var e=c.split("&");for(var d=0,a=e.length;d<a;d++){var f=e[d].split("=");b[f[0]]=decodeURIComponent(f[1]);}return b;},_strToTime:function(a){(/^([\d\.-]+)([a-zA-Z])$/).test(a);var c=[Number(RegExp.$1,10),RegExp.$2];var b;switch(c[1]){case"m":b=60000;break;case"h":b=3600000;break;case"d":b=86400000;break;default:b=false;}return(b)?c[0]*b:false;},set:function(c,g,j,b){j=j||{};if(c&&(g!=undefined)){if(!b){g=encodeURIComponent(g);}var h=c+"="+g;var d="";if(j.expires){var f=new Date();f.setTime(f.getTime()+this._strToTime(j.expires));d="; expires="+f.toUTCString();}var i="; path="+(j.path||"/");var e="; domain="+(j.domain||window.location.host);var a=j.secure?"; secure":"";document.cookie=h+d+i+e+a;return true;}return false;},setSub:function(d,f,e,c){c=c||{};if(d&&f&&e){var b=this.get(d);var a=this._deserialize(b);a[f]=e;return this.setSubs(d,a,c);}},setSubs:function(c,d,b){b=b||{};if(c&&d){var a=this._serialize(d);return this.set(c,a,b,true);}},get:function(b){var e=document.cookie.split(/;\s/g);var d=b.length+1;for(var c=0,a=e.length;c<a;c++){if(e[c].substring(0,d)==(b+"=")){return decodeURIComponent(e[c].substring(d));}}return false;},getSub:function(b,c){if(b&&c){var a=this.getSubs(b);if(a[c]!=undefined){return a[c];}}return false;},getSubs:function(c){if(c){var b=this.get(c);if(b){var a=this._deserialize(b);return a;}return false;}return false;},remove:function(b,a){if(b){a=a||{};a.expires="-1m";return this.set(b,"",a);}return false;},removeSub:function(d,f,c){if(d&&f){c=c||{};var b=this.get(d);var a=this._deserialize(b);delete a[f];for(var e in a){if(a.hasOwnProperty(e)){return this.setSubs(d,a,c);}}return this.remove(d,c);}}};

/* http://www.JSON.org/json2.js */
if(!this.JSON){this.JSON={};}(function(){function f(n){return n<10?"0"+n:n;}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null;};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf();};}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4);})+'"':'"'+string+'"';}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key);}if(typeof rep==="function"){value=rep.call(holder,key,value);}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null";}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null";}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v;}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v);}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v);}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v;}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" ";}}else{if(typeof space==="string"){indent=space;}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify");}return str("",{"":value});};}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v;}else{delete value[k];}}}}return reviver.call(holder,key,value);}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4);});}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j;}throw new SyntaxError("JSON.parse");};}}());

/* SimpleModal 1.4.1 *modified* */
(function(d){d.boxModel=true;var c=d.browser.msie&&parseInt(d.browser.version)===6&&typeof window.XMLHttpRequest!=="object",b=d.browser.msie&&parseInt(d.browser.version)===7,e=null,a=[];d.modal=function(g,f){return d.modal.impl.init(g,f);};d.modal.close=function(){d.modal.impl.close();};d.modal.focus=function(f){d.modal.impl.focus(f);};d.modal.setContainerDimensions=function(){d.modal.impl.setContainerDimensions();};d.modal.setPosition=function(){d.modal.impl.setPosition();};d.modal.update=function(f,g){d.modal.impl.update(f,g);};d.fn.modal=function(f){return d.modal.impl.init(this,f);};d.modal.defaults={appendTo:"body",focus:true,opacity:50,overlayId:"simplemodal-overlay",overlayCss:{},containerId:"simplemodal-container",containerCss:{},dataId:"simplemodal-data",dataCss:{},minHeight:null,minWidth:null,maxHeight:null,maxWidth:null,autoResize:false,autoPosition:true,zIndex:1000,close:true,closeHTML:'<a class="modalCloseImg" title="Close"></a>',closeClass:"simplemodal-close",escClose:true,overlayClose:false,position:null,persist:false,modal:true,onOpen:null,onShow:null,onClose:null};d.modal.impl={d:{},init:function(h,f){var g=this;if(g.d.data){return false;}e=d.browser.msie&&!d.boxModel;g.o=d.extend({},d.modal.defaults,f);g.zIndex=g.o.zIndex;g.occb=false;if(typeof h==="object"){h=h instanceof jQuery?h:d(h);g.d.placeholder=false;if(h.parent().parent().size()>0){h.before(d("<span></span>").attr("id","simplemodal-placeholder").css({display:"none"}));g.d.placeholder=true;g.display=h.css("display");if(!g.o.persist){g.d.orig=h.clone(true);}}}else{if(typeof h==="string"||typeof h==="number"){h=d("<div></div>").html(h);}else{alert("SimpleModal Error: Unsupported data type: "+typeof h);return g;}}g.create(h);h=null;g.open();if(d.isFunction(g.o.onShow)){g.o.onShow.apply(g,[g.d]);}return g;},create:function(g){var f=this;a=f.getDimensions();if(f.o.modal&&c){f.d.iframe=d('<iframe src="javascript:false;"></iframe>').css(d.extend(f.o.iframeCss,{display:"none",opacity:0,position:"fixed",height:a[0],width:a[1],zIndex:f.o.zIndex,top:0,left:0})).appendTo(f.o.appendTo);}f.d.overlay=d("<div></div>").attr("id",f.o.overlayId).addClass("simplemodal-overlay").css(d.extend(f.o.overlayCss,{display:"none",opacity:f.o.opacity/100,height:f.o.modal?a[0]:0,width:f.o.modal?a[1]:0,position:"fixed",left:0,top:0,zIndex:f.o.zIndex+1})).appendTo(f.o.appendTo);f.d.container=d("<div></div>").attr("id",f.o.containerId).addClass("simplemodal-container").css(d.extend(f.o.containerCss,{display:"none",position:"fixed",zIndex:f.o.zIndex+2})).append(f.o.close&&f.o.closeHTML?d(f.o.closeHTML).addClass(f.o.closeClass):"").appendTo(f.o.appendTo);f.d.wrap=d("<div></div>").attr("tabIndex",-1).addClass("simplemodal-wrap").css({height:"100%",outline:0,width:"100%"}).appendTo(f.d.container);f.d.data=g.attr("id",g.attr("id")||f.o.dataId).addClass("simplemodal-data").css(d.extend(f.o.dataCss,{display:"none"})).appendTo("body");g=null;f.setContainerDimensions();f.d.data.appendTo(f.d.wrap);if(c||e){f.fixIE();}},bindEvents:function(){var f=this;d("."+f.o.closeClass).bind("click.simplemodal",function(g){g.preventDefault();f.close();});if(f.o.modal&&f.o.close&&f.o.overlayClose){f.d.overlay.bind("click.simplemodal",function(g){g.preventDefault();f.close();});}d(document).bind("keydown.simplemodal",function(g){if(f.o.modal&&g.keyCode===9){f.watchTab(g);}else{if((f.o.close&&f.o.escClose)&&g.keyCode===27){g.preventDefault();f.close();}}});d(window).bind("resize.simplemodal",function(){a=f.getDimensions();f.o.autoResize?f.setContainerDimensions():f.o.autoPosition&&f.setPosition();if(c||e){f.fixIE();}else{if(f.o.modal){f.d.iframe&&f.d.iframe.css({height:a[0],width:a[1]});f.d.overlay.css({height:a[0],width:a[1]});}}});},unbindEvents:function(){d("."+this.o.closeClass).unbind("click.simplemodal");d(document).unbind("keydown.simplemodal");d(window).unbind("resize.simplemodal");this.d.overlay.unbind("click.simplemodal");},fixIE:function(){var f=this,g=f.o.position;d.each([f.d.iframe||null,!f.o.modal?null:f.d.overlay,f.d.container],function(t,l){if(l){var q="document.body.clientHeight",v="document.body.clientWidth",x="document.body.scrollHeight",u="document.body.scrollLeft",o="document.body.scrollTop",k="document.body.scrollWidth",j="document.documentElement.clientHeight",r="document.documentElement.clientWidth",p="document.documentElement.scrollLeft",y="document.documentElement.scrollTop",z=l[0].style;z.position="absolute";if(t<2){z.removeExpression("height");z.removeExpression("width");z.setExpression("height",""+x+" > "+q+" ? "+x+" : "+q+' + "px"');z.setExpression("width",""+k+" > "+v+" ? "+k+" : "+v+' + "px"');}else{var n,h;if(g&&g.constructor===Array){var w=g[0]?typeof g[0]==="number"?g[0].toString():g[0].replace(/px/,""):l.css("top").replace(/px/,"");n=w.indexOf("%")===-1?w+" + (t = "+y+" ? "+y+" : "+o+') + "px"':parseInt(w.replace(/%/,""))+" * (("+j+" || "+q+") / 100) + (t = "+y+" ? "+y+" : "+o+') + "px"';if(g[1]){var m=typeof g[1]==="number"?g[1].toString():g[1].replace(/px/,"");h=m.indexOf("%")===-1?m+" + (t = "+p+" ? "+p+" : "+u+') + "px"':parseInt(m.replace(/%/,""))+" * (("+r+" || "+v+") / 100) + (t = "+p+" ? "+p+" : "+u+') + "px"';}}else{n="("+j+" || "+q+") / 2 - (this.offsetHeight / 2) + (t = "+y+" ? "+y+" : "+o+') + "px"';h="("+r+" || "+v+") / 2 - (this.offsetWidth / 2) + (t = "+p+" ? "+p+" : "+u+') + "px"';}z.removeExpression("top");z.removeExpression("left");z.setExpression("top",n);z.setExpression("left",h);}}});},focus:function(i){var g=this,h=i&&d.inArray(i,["first","last"])!==-1?i:"first";var f=d(":input:enabled:visible:"+h,g.d.wrap);setTimeout(function(){f.length>0?f.focus():g.d.wrap.focus();},10);},getDimensions:function(){var g=d(window);var f=d.browser.opera&&d.browser.version>"9.5"&&d.fn.jquery<"1.3"||d.browser.opera&&d.browser.version<"9.5"&&d.fn.jquery>"1.2.6"?g[0].innerHeight:g.height();return[f,g.width()];},getVal:function(f,g){return f?(typeof f==="number"?f:f==="auto"?0:f.indexOf("%")>0?((parseInt(f.replace(/%/,""))/100)*(g==="h"?a[0]:a[1])):parseInt(f.replace(/px/,""))):null;},update:function(f,h){var g=this;if(!g.d.data){return false;}g.d.origHeight=g.getVal(f,"h");g.d.origWidth=g.getVal(h,"w");g.d.data.hide();f&&g.d.container.css("height",f);h&&g.d.container.css("width",h);g.setContainerDimensions();g.d.data.show();g.o.focus&&g.focus();g.unbindEvents();g.bindEvents();},setContainerDimensions:function(){var q=this,i=c||b;var f=q.d.origHeight?q.d.origHeight:d.browser.opera?q.d.container.height():q.getVal(i?q.d.container[0].currentStyle.height:q.d.container.css("height"),"h"),h=q.d.origWidth?q.d.origWidth:d.browser.opera?q.d.container.width():q.getVal(i?q.d.container[0].currentStyle.width:q.d.container.css("width"),"w"),m=q.d.data.outerHeight(true),g=q.d.data.outerWidth(true);q.d.origHeight=q.d.origHeight||f;q.d.origWidth=q.d.origWidth||h;var j=q.o.maxHeight?q.getVal(q.o.maxHeight,"h"):null,n=q.o.maxWidth?q.getVal(q.o.maxWidth,"w"):null,l=j&&j<a[0]?j:a[0],p=n&&n<a[1]?n:a[1];var k=q.o.minHeight?q.getVal(q.o.minHeight,"h"):"auto";if(!f){if(!m){f=k;}else{if(m>l){f=l;}else{if(q.o.minHeight&&k!=="auto"&&m<k){f=k;}else{f=m;}}}}else{f=q.o.autoResize&&f>l?l:f<k?k:f;}var o=q.o.minWidth?q.getVal(q.o.minWidth,"w"):"auto";if(!h){if(!g){h=o;}else{if(g>p){h=p;}else{if(q.o.minWidth&&o!=="auto"&&g<o){h=o;}else{h=g;}}}}else{h=q.o.autoResize&&h>p?p:h<o?o:h;}q.d.container.css({height:f,width:h});q.d.wrap.css({overflow:(m>f||g>h)?"auto":"visible"});q.o.autoPosition&&q.setPosition();},setPosition:function(){var g=this,i,h,j=(a[0]/2)-(g.d.container.outerHeight(true)/2),f=(a[1]/2)-(g.d.container.outerWidth(true)/2);if(g.o.position&&Object.prototype.toString.call(g.o.position)==="[object Array]"){i=g.o.position[0]||j;h=g.o.position[1]||f;}else{i=j;h=f;}g.d.container.css({left:h,top:i});},watchTab:function(g){var f=this;if(d(g.target).parents(".simplemodal-container").length>0){f.inputs=d(":input:enabled:visible:first, :input:enabled:visible:last",f.d.data[0]);if((!g.shiftKey&&g.target===f.inputs[f.inputs.length-1])||(g.shiftKey&&g.target===f.inputs[0])||f.inputs.length===0){g.preventDefault();var h=g.shiftKey?"last":"first";f.focus(h);}}else{g.preventDefault();f.focus();}},open:function(){var f=this;f.d.iframe&&f.d.iframe.show();if(d.isFunction(f.o.onOpen)){f.o.onOpen.apply(f,[f.d]);}else{f.d.overlay.show();f.d.container.show();f.d.data.show();}f.o.focus&&f.focus();f.bindEvents();},close:function(){var f=this;if(!f.d.data){return false;}f.unbindEvents();if(d.isFunction(f.o.onClose)&&!f.occb){f.occb=true;f.o.onClose.apply(f,[f.d]);}else{if(f.d.placeholder){var g=d("#simplemodal-placeholder");if(f.o.persist){g.replaceWith(f.d.data.removeClass("simplemodal-data").css("display",f.display));}else{f.d.data.hide().remove();g.replaceWith(f.d.orig);}}else{f.d.data.hide().remove();}f.d.container.hide().remove();f.d.overlay.hide();f.d.iframe&&f.d.iframe.hide().remove();setTimeout(function(){f.d.overlay.remove();f.d={};},10);}}};})(jQuery);

/*HoverIntent r5 */
﻿(function($){$.fn.hoverIntent=function(f,g){var cfg={sensitivity:7,interval:100,timeout:0};cfg=$.extend(cfg,g?{over:f,out:g}:f);var cX,cY,pX,pY;var track=function(ev){cX=ev.pageX;cY=ev.pageY;};var compare=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);if((Math.abs(pX-cX)+Math.abs(pY-cY))<cfg.sensitivity){$(ob).unbind("mousemove",track);ob.hoverIntent_s=1;return cfg.over.apply(ob,[ev]);}else{pX=cX;pY=cY;ob.hoverIntent_t=setTimeout(function(){compare(ev,ob);},cfg.interval);}};var delay=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);ob.hoverIntent_s=0;return cfg.out.apply(ob,[ev]);};var handleHover=function(e){var p=(e.type=="mouseover"?e.fromElement:e.toElement)||e.relatedTarget;while(p&&p!=this){try{p=p.parentNode;}catch(e){p=this;}}if(p==this){return false;}var ev=jQuery.extend({},e);var ob=this;if(ob.hoverIntent_t){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);}if(e.type=="mouseover"){pX=ev.pageX;pY=ev.pageY;$(ob).bind("mousemove",track);if(ob.hoverIntent_s!=1){ob.hoverIntent_t=setTimeout(function(){compare(ev,ob);},cfg.interval);}}else{$(ob).unbind("mousemove",track);if(ob.hoverIntent_s==1){ob.hoverIntent_t=setTimeout(function(){delay(ev,ob);},cfg.timeout);}}};return this.mouseover(handleHover).mouseout(handleHover);};})(jQuery);

/* Menu 0.9 */
$.fn.menu=function(g,f){var e=this;$(this).addClass("tc-menu");var c=$(document.getElementById(g));var b=function(){e.addClass("open");c.show();$("body").bind("click",a);};var a=function(h,i){$("body").unbind("click",a);c.hide();e.removeClass("open");if(h&&f){f(h,i);}};var d=function(){if($("#simplemodal-container").length>0){return;}c.trigger("toggleMenu",e);if(c.is(":visible")){a();}else{$(".tc-menu").trigger("close");b();}};e.bind("close",function(h){a(h,false);});e.click(function(h){h.preventDefault();h.stopImmediatePropagation();d();});c.click(function(h){h.stopImmediatePropagation();if(h.target.nodeName==="LI"||h.target.nodeName==="A"||h.target.nodeName==="SPAN"){a(h,true);}});return e;};

/* TrueCar.QueryString */
if(!window.TrueCar){throw new Error("TrueCar.QueryString requires TrueCar");}TrueCar.QueryString=TrueCar.QueryString||{VERSION:"0.9.4",data:{},init:function(){var e=window.location.search.substring(1);if(e.length){var d=e.split("&");if(d.length){for(var b=0,a=d.length;b<a;b++){var c=d[b].split("=");if((c.length==2)){this.data[decodeURI(c[0])]=decodeURI(c[1]);}}}}},set:function(b,c){if(typeof b==="string"&&typeof c==="string"){this.data[b]=c;return true;}else{if(typeof b==="object"&&!c){var a=b;for(var b in a){if(a.hasOwnProperty(b)){this.data[b]=a[b];}}return true;}else{return false;}}},get:function(a){if(this.data[a]===undefined){return false;}else{return this.data[a];}},remove:function(a){if(this.data[a]){delete this.data[a];return true;}else{return false;}},toQS:function(){var a="?";for(var b in this.data){if(this.data.hasOwnProperty(b)){if(a!="?"){a+="&";}a+=b+"="+this.data[b];}}return encodeURI(a);},toJSON:function(){return JSON.stringify(this.data);},updateURL:function(){window.location.search=this.toQS();}};

/* TrueCar.ZIPCode */
if(!window.TrueCar){throw new Error("TrueCar.ZIPCode requires TrueCar");}if(!window.TrueCar.QueryString){throw new Error("TrueCar.ZIPCode requires TrueCar.QueryString");}if(!jQuery){throw new Error("TrueCar.Options requires jQuery");}if(!$.cookie){throw new Error("TrueCar.Options requires $.cookie");}TrueCar.ZIPCode=TrueCar.ZIPCode||{VERSION:"0.9.6",data:{passed:false,zipcode:"",dma:"",stateid:"",state:"",city:""},init:function(){var a=TrueCar.QueryString.get("zipcode");if(a){if(window.console){console.log("zipcode from querystring");}this.validate(a,false);}else{var b=$.cookie("zipcode2");if(b){if(window.console){console.log("zipcode from cookie");}this.validate(b,false);}else{if(this.ipToZip()){if(window.console){console.log("zipcode from ip");}}else{if(/googlebot|google web preview/.test(navigator.userAgent.toLowerCase)){this.validate("90401",false);}else{this.modal();}}}}$("#zipcode_submit").bind("click",function(c){c.preventDefault();TrueCar.ZIPCode.validate($("#zipcode_input").val(),true);});$("#zipcode_input").bind("keyup",function(c){if(c.keyCode==13){TrueCar.ZIPCode.validate($("#zipcode_input").val(),true);}});},set:function(b,a,d,c,e){TrueCar.ZIPCode.data.zipcode=b;TrueCar.ZIPCode.data.dma=a;TrueCar.ZIPCode.data.stateid=d;TrueCar.ZIPCode.data.state=c;TrueCar.ZIPCode.data.city=e;TrueCar.QueryString.set("zipcode",b);$.cookie("zipcode2",b,{expires:720,path:"/",domain:"truecar.com"});$.cookie("dma2",a,{expires:720,path:"/",domain:"truecar.com"});$.cookie("stateid2",d,{expires:720,path:"/",domain:"truecar.com"});$("#zipcode_input").val(b);if(window.console){console.log("zipcode set: "+b+", "+a+", "+d);}if(e&&c){$(".location").html(e+", "+c);}else{$(".location").html(b);}return true;},clear:function(){this.data={passed:false,zipcode:"",dma:"",stateid:"",state:"",city:""};$.cookie("zipcode2",null,{path:"/",domain:"truecar.com"});$.cookie("dma2",null,{path:"/",domain:"truecar.com"});$.cookie("stateid2",null,{path:"/",domain:"truecar.com"});$("#zipcode_input").val("");return true;},modal:function(){if(TrueCar.Utilities.isIE(6)||TrueCar.Utilities.isIE(7)){var a=prompt("Please enter your ZIP code so we can give you accurate pricing for your area.","");this.modalCallback(a);}else{$.modal('<p>Please enter your ZIP code so we can<br/> give you accurate pricing for your area.</p><p><input id="zipcode_modal_input" type="text" size="5" maxlength="5" /> <a href="#" class="button" id="zipcode_modal_submit"><span class="text">Go</span><span class="icon"></span></a></p><p><span id="zipcode_modal_skip" class="link simplemodal-close">Skip for now</span></p>',{minHeight:100,minWidth:250,overlayClose:true,closeHTML:"",opacity:80,onClose:function(){TrueCar.ZIPCode.modalCallback($("#zipcode_modal_input").val(),false);$.modal.close();},onShow:function(){$("#zipcode_modal_submit").bind("click",function(b){b.preventDefault();$.modal.close();});$("#zipcode_modal_input").bind("keyup",function(b){if(b.keyCode==13){$.modal.close();}});}});}},modalCallback:function(a){if(a){if(!TrueCar.ZIPCode.validate(a,false)){if(window.console){console.log("modalCallback: validate failed");}TrueCar.ZIPCode.validate("90401",false);}}else{if(window.console){console.log("modalCallback: no zipcode sent");}TrueCar.ZIPCode.validate("90401",false);}},ipToZip:function(){$.ajax({url:"/api/zipcodes/",async:false,dataType:"xml",dataFilter:function(d){if(!$("zipGeography",d).attr("use_default")){var b=$("zipGeography",d).attr("zipcode");var a=$("zipGeography",d).attr("DMA_Id");var e=$("zipGeography",d).attr("State_Id");var c=$("zipGeography",d).attr("state")||null;var f=$("zipGeography",d).attr("city")||null;if(TrueCar.ZIPCode.set(b,a,e,c,f)){if(window.console){console.log("zipcode "+b+" valid");}TrueCar.ZIPCode.data.passed=true;}}}});return TrueCar.ZIPCode.data.passed;},validate:function(b,a){if(/^\d{5}$/.test(b)&&b!==TrueCar.ZIPCode.data.zipcode){$.ajax({url:"/api/zipcodes/"+b+".xml",async:false,dataType:"xml",dataFilter:function(e){if($("zipGeography",e).attr("valid")==1){var c=$("zipGeography",e).attr("DMA_Id");var f=$("zipGeography",e).attr("State_Id");var d=$("zipGeography",e).attr("state")||null;var g=$("zipGeography",e).attr("city")||null;if(TrueCar.ZIPCode.set(b,c,f,d,g)){$("#change_zip").hide();if(window.console){console.log("zipcode "+b+" valid");}TrueCar.ZIPCode.data.passed=true;if(a){if(/zipcode/.test(window.location.search)){TrueCar.QueryString.updateURL();}else{window.location.reload();}}}}else{if(window.console){console.log("zipcode "+b+" invalid");}$.modal('<p><strong>Oops!</strong> It looks like you\'ve entered an<br/> invalid ZIP code. Please try again.</p><p style="text-align:center;"><button class="button simplemodal-close"><span>OK</span></button></p>',{minHeight:100,minWidth:250,overlayClose:true,closeHTML:"",opacity:80,onClose:function(){$.modal.close();if(!TrueCar.Utilities.isIE()){setTimeout(function(){$("#change_zip_trigger").trigger("click");},100);}}});$("#zipcode_input").val(TrueCar.ZIPCode.data.zipcode);TrueCar.ZIPCode.data.passed=false;}}});return TrueCar.ZIPCode.data.passed;}else{if(!TrueCar.ZIPCode.data.zipcode){TrueCar.ZIPCode.validate("90401",true);return false;}if(window.console){console.log("zipcode "+b+" invalid or current");}if((b!=TrueCar.ZIPCode.data.zipcode)&&(b!="")){$.modal('<p><strong>Oops!</strong> It looks like you\'ve entered an<br/> invalid ZIP code. Please try again.</p><p style="text-align:center;"><button class="button simplemodal-close"><span>OK</span></button></p>',{minHeight:100,minWidth:250,overlayClose:true,closeHTML:"",opacity:80,onClose:function(){$.modal.close();if(!TrueCar.Utilities.isIE()){setTimeout(function(){$("#change_zip_trigger").trigger("click");},100);}}});}$("#zipcode_input").val(TrueCar.ZIPCode.data.zipcode);return false;}}};

/* global.js */
TrueCar.QueryString.init();(function(){var b=TrueCar.QueryString.get("sourceId"),a=TrueCar.QueryString.get("campaignId");if(b===""){b="0";}if(a===""){a="0";}if(b){$.cookie("sourceId",b,{expires:720,path:"/",domain:"truecar.com"});$.cookie("campaignId",null,{path:"/",domain:"truecar.com"});TrueCar.QueryString.remove("sourceId");}if(a){$.cookie("campaignId",a,{expires:720,path:"/",domain:"truecar.com"});TrueCar.QueryString.remove("campaignId");}})();if($(".tc-hover").length){$(".tc-hover").hoverIntent({interval:300,over:function(b){var a=$(this);var c=$(this).children(".panel").first();c.show();if(c.hasClass("right")){c.position({of:a,my:"right top",at:"left top",offset:"-20 -15"});}else{if(c.hasClass("left")){c.position({of:a,my:"left top",at:"right top",offset:"20 -15"});}}},out:function(a){$(this).children(".panel").hide();}});}if($("#zipcode_input").length){TrueCar.ZIPCode.init();}$(".loading-text").each(function(){$(this).text($(this).attr("data-text"));});
